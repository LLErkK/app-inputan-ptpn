<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - PTPN</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/input-baku.css">
</head>
<body>
<div class="dashboard-container">
    <!-- Sidebar -->
    <div class="sidebar">
        <img src="/asset/logoptpn.png" alt="Logo" class="logo">

        <div class="menu">
            <a href="/rekap" target="mainFrame">Dashboard</a>
            <!-- <a href="/baku" target="mainFrame">Input</a> -->
             <a href="/upload" target="mainFrame">Upload</a>
            <a href="/monitoring" target="mainFrame">Monitoring</a>
            <a href="/perbandingan" target="mainFrame">Perbandingan</a>
            <a href="/visualisasi" target="mainFrame">Visualisasi</a>
            <a href="/peta" target="mainFrame">Peta</a>
            <a href="/manajemen" target="mainFrame">Manajemen Akun</a>
        </div>

        <div class="logout" id="btn-logout" style="cursor: pointer;">Logout</div>
    </div>

    <!-- Content pakai iframe -->
    <div class="content">
        <iframe name="mainFrame" id="mainFrame" frameborder="0"></iframe>
    </div>
</div>

<!-- <script src="/js/script.js"></script> -->
<!-- <script src="/js/baku.js"></script> -->

<script>
    // Fungsi untuk set menu active
    function setActiveMenu(path) {
        const links = document.querySelectorAll(".menu a");

        links.forEach(link => {
            link.classList.remove("active");
            const target = link.getAttribute("href").replace("/", "");

            if (target === path) {
                link.classList.add("active");
            }
        });
    }

    document.addEventListener("DOMContentLoaded", () => {
        const params = new URLSearchParams(window.location.search);
        const tab = params.get("tab") || "rekap";
        const frame = document.getElementById("mainFrame");

        // Load halaman saat pertama kali
        frame.src = "/" + tab;

        // Set menu active saat pertama kali
        setActiveMenu(tab);

        // Set menu active ketika menu di-klik
        document.querySelectorAll(".menu a").forEach(link => {
            link.addEventListener("click", () => {
                const path = link.getAttribute("href").replace("/", "");
                setActiveMenu(path);
            });
        });
    });

    // Tombol logout
    const btnLogout = document.getElementById("btn-logout");
    if (btnLogout) {
        btnLogout.addEventListener("click", async () => {
            try {
                await fetch("/logout", { method: "GET" });
                window.location.href = "/";
            } catch (err) {
                console.error("Gagal logout:", err);
            }
        });
    }
</script>
</body>
</html>
